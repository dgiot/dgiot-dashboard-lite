import{r as u,bg as Z,j as y,v,bl as m,bk as H,a as P}from"./vendor.fa662155.js";function _(t,e,o){e===void 0&&(e={}),o===void 0&&(o=[]),o.forEach(a=>{var r="enable"+a,i=e[r]?"enable"+a:"disable"+a;t&&e[r]!==void 0&&t[i]&&t[i]()})}function j(t,e){e===void 0&&(e={});var o=e.visiable,[a,r]=u.exports.useState(o);u.exports.useEffect(()=>{t&&o!==void 0&&(o?t.show&&t.show():t.hide&&t.hide(),o!==a&&r(o))},[t,a,o])}function A(t,e,o){o===void 0&&(o=[]),o.forEach(a=>{var r=""+a.charAt(0).toLowerCase()+a.slice(1),[i,l]=u.exports.useState(e[r]);u.exports.useEffect(()=>{if(t&&t["set"+a]&&e[r]!==void 0){var s=e[r];if(s&&s.lng&&s.lat){s=new BMap.Point(s.lng,s.lat);var n=i;if(n&&n.lng&&n.lat&&(n=new BMap.Point(n.lng,n.lat),s.equals(n)))return}t["set"+a](s),i!==e[r]&&(r==="bounds"?i&&e[r]&&!i.equals(e[r])&&l(e[r]):l(e[r]))}},[t,e[r]])})}function Q(t,e,o,a){e===void 0&&(e={}),o===void 0&&(o=[]),o.forEach(r=>{var i="on"+r,l=e[i];u.exports.useEffect(()=>{if(!!t&&l&&r){var s=r;return a==="CamelCase"?s=r.replace(r[0],r[0].toLowerCase()):s=r.toLowerCase(),t.addEventListener(s,l),()=>{t.removeEventListener(s,l)}}},[t,e[i]])})}function q(t){var e=u.exports.useRef();return u.exports.useEffect(()=>{e.current=t}),e.current}function z(t){var e=u.exports.useRef(document.createElement("div"));return u.exports.useLayoutEffect(()=>{Z.exports.render(y(u.exports.Fragment,{children:t.children}),e.current)},[t.children]),{container:e.current}}var k={};function V(t){var e=document&&(document.head||document.getElementsByTagName("head")[0]);return new Promise((o,a)=>{if(!document||t in k){o();return}var r=document.createElement("script");r.type="text/javascript",r.id="_react_baidu_map",r.src=t,r.async=!0,r.defer=!0,r.onerror=i=>{e.removeChild(r),a(new URIError("The Script "+t+" is no accessible."))},r.onload=()=>{k[t]=!0,o()},e.appendChild(r)})}function L(t,e,o,a,r,i,l){try{var s=t[i](l),n=s.value}catch(M){o(M);return}s.done?e(n):Promise.resolve(n).then(a,r)}function R(t){return function(){var e=this,o=arguments;return new Promise(function(a,r){var i=t.apply(e,o);function l(n){L(i,a,r,l,s,"next",n)}function s(n){L(i,a,r,l,s,"throw",n)}l(void 0)})}}function F(t){return new Promise((e,o)=>{window&&window.setTimeout(e,t)})}var T=3;class w extends v.Component{static ready(){return R(function*(){if(!(window&&window.BMap.Map)&&!(window&&window.BMapGL.Map))return new Promise((e,o)=>{w.waitQueue.push([e,o])})})()}constructor(e){super(e);if(this.isMountedOk=!1,this.handleError=o=>{this.isMountedOk&&this.setState({error:o})},this.finish=()=>{window&&this.props.type==="webgl"&&(window.BMap=window.BMapGL),this.isMountedOk&&this.setState({loaded:!0})},this.state={loaded:e.type==="webgl"?window&&!!window.BMapGL&&!!window.BMapGL.Map:window&&!!window.BMap&&!!window.BMap.Map},this.props.akay==null)throw new TypeError("BaiDuMap: akay is required")}componentDidMount(){this.isMountedOk=!0;var{callbackName:e}=this.props;if(!(!window||!e)&&(this.props.type==="webgl"&&window&&window.BMapGL&&!window.BMapGL.Map||this.props.type==="webgl"&&window&&!window.BMapGL||window&&window.BMap&&!window.BMap.Map||window&&!window.BMap)){if(window&&window[e]){w.waitQueue.push([this.finish,this.handleError]);return}this.loadMap()}}componentWillUnmount(){this.isMountedOk=!1}render(){return this.state.loaded?this.props.children:this.props.fallback?this.props.fallback(this.state.error):this.state.error?y("div",{style:{color:"red"},children:this.state.error.message}):null}getScriptSrc(){var e=this.props,o=e.protocol||window.location.protocol;o.indexOf(":")===-1&&(o+=":");var a=["v="+e.version,"ak="+e.akay,"callback="+e.callbackName];return e.type&&a.push("type="+e.type),o+"//"+e.hostAndPath+"?"+a.join("&")}loadMap(){var e=this;return R(function*(){var{callbackName:o}=e.props;if(!(!window||!o)){var a=e.getScriptSrc();window[o]=()=>{var l=w.waitQueue;w.waitQueue=[],l.forEach(s=>s[0]()),e.finish()};for(var r=0;r<T;r++)try{yield V(a);break}catch(l){if(r===T-1){var i=function(){var s=new Error("Failed to load Baidu Map: "+l.message),n=w.waitQueue;return w.waitQueue=[],n.forEach(M=>M[1](s)),e.handleError(s),{v:void 0}}();if(typeof i=="object")return i.v}yield F(r*1e3)}}})()}}w.defaultProps={akay:"",hostAndPath:"api.map.baidu.com/api",version:"3.0",callbackName:"load_bmap_sdk",type:""};w.waitQueue=[];var D={map:void 0,BMap:void 0,container:void 0},I=(t,e)=>m({},t,e),b=v.createContext({state:D,dispatch:()=>null});function N(){var{state:t,dispatch:e}=u.exports.useContext(b);return m({},t,{state:t,dispatch:e})}function U(t){t===void 0&&(t={});var{widget:e,minZoom:o,maxZoom:a,mapType:r,enableHighResolution:i,enableAutoResize:l,enableMapClick:s}=t,[n,M]=u.exports.useState(),[C,x]=u.exports.useState(t.zoom||15),[h,f]=u.exports.useState(t.container),{dispatch:E}=u.exports.useContext(b);u.exports.useMemo(()=>{if(h&&!n&&BMap){var p=new BMap.Map(h,{minZoom:o,maxZoom:a,mapType:r,enableHighResolution:i,enableAutoResize:l,enableMapClick:s});e&&e.forEach(c=>{if(!!BMap){if(typeof c=="string")p.addControl(new BMap[c]);else if(typeof c=="object"&&c.control&&typeof c.control=="function")p.addControl(c.control(BMap,p));else if(typeof c=="object"&&c.name){var G=typeof c.options=="function"?c.options(BMap,p):c.options;p.addControl(new BMap[c.name](G))}}}),M(p)}return()=>{n&&n.clearOverlays()}},[h,n]),u.exports.useEffect(()=>(n&&h&&E({map:n,container:h,BMap}),()=>{E({map:void 0,container:void 0,BMap:void 0})}),[n,h]);var[d,g]=u.exports.useState(t.center||"\u4E0A\u6D77");u.exports.useEffect(()=>{if(n&&d){var p=d;d&&d.lng&&d.lat&&(p=new BMap.Point(d.lng,d.lat),n.centerAndZoom(p,C)),n.centerAndZoom(d,C)}},[d,n]);var[B,S]=u.exports.useState(t.autoLocalCity);return u.exports.useEffect(()=>{if(n&&B){var p=new BMap.LocalCity;p.get(c=>{g(c.name),x(c.level),S(!1)})}},[B,n]),Q(n,t,["Click","DblClick","RightClick","RightdblClick","MapTypeChange","MouseMove","MouseOver","MouseOut","MoveStart","Moving","MoveEnd","ZoomStart","ZoomEnd","AddOverlay","AddControl","RemoveControl","RemoveOverlay","ClearOverlays","DragStart","Dragging","DragEnd","AddTileLayer","RemoveTileLayer","Load","ReSize","HotspotClick","HotspotOver","HotspotOut","TilesLoaded","TouchStart","TouchMove","TouchEnd","LongPress"]),A(n,t,["DefaultCursor","DraggingCursor","MinZoom","MaxZoom","MapStyle","MapStyleV2","Panorama","CurrentCity","MapType","Viewport","Zoom"]),_(n,t,["Dragging","ScrollWheelZoom","DoubleClickZoom","Keyboard","InertialDragging","ContinuousZoom","PinchToZoom","AutoResize"]),{map:n,setMap:M,zoom:C,setZoom:x,container:h,setContainer:f,center:d,setCenter:g,autoLocalCity:B,setAutoLocalCity:S}}var W=["className","style","children"],O=v.forwardRef((t,e)=>{var{className:o,style:a,children:r}=t,i=H(t,W),[l,s]=u.exports.useReducer(I,D);window.BMap=window.BMap||window.BMapGL;var n=u.exports.useRef(null),{setContainer:M,container:C,setCenter:x,setAutoLocalCity:h,map:f}=U(m({container:n.current},i));u.exports.useEffect(()=>M(n.current),[n.current]),u.exports.useMemo(()=>i.center&&x(i.center),[i.center]),u.exports.useEffect(()=>h(i.autoLocalCity),[i.autoLocalCity]),u.exports.useImperativeHandle(e,()=>m({},i,{map:f,BMap,container:n.current}),[f]);var E=v.Children.toArray(r);return u.exports.useEffect(()=>{f&&s({map:f,container:n.current,BMap})},[f]),P(b.Provider,{value:{state:l,dispatch:s},children:[y("div",{ref:n,className:o,style:m({fontSize:1,height:"100%"},a)}),BMap&&f&&typeof r=="function"&&r({BMap,map:f,container:C}),BMap&&f&&E.map((d,g)=>v.isValidElement(d)?d.type&&typeof d.type=="string"?v.cloneElement(d,{key:g}):v.cloneElement(d,m({},d.props,{BMap,map:f,container:C,key:g})):null)]})});function K(t){t===void 0&&(t={});var[e,o]=u.exports.useState(),{anchor:a,offset:r}=t,{map:i}=N();return u.exports.useEffect(()=>{if(i&&!e){var l=new BMap.CopyrightControl({anchor:a||BMAP_ANCHOR_TOP_RIGHT,offset:r});i.addControl(l),o(l)}return()=>{i&&e&&i.removeControl(e)}},[i,e,a,r]),j(e,t),A(e,t,["Anchor","Offset"]),{copyrightControl:e,setCopyrightControl:o}}var X=1;function Y(t){t===void 0&&(t={});var{children:e,control:o,bounds:a}=t,[r]=u.exports.useState(X++),{container:i}=z({children:e}),l=q(r);return u.exports.useEffect(()=>(o&&o.addCopyright({id:r,bounds:a,content:i.innerHTML}),function(){l&&o&&o.removeCopyright(l)}),[e,o]),null}var J=v.forwardRef((t,e)=>{var{copyrightControl:o}=K(t);return u.exports.useImperativeHandle(e,()=>m({},t,{copyrightControl:o}),[o]),y(u.exports.Fragment,{children:v.Children.toArray(t.children).map((a,r)=>v.isValidElement(a)?v.cloneElement(a,{control:o,id:r+1}):a)})});J.Item=Y;function ee(){return y(()=>y("div",{style:{width:"100%",height:"44vh"},children:P(w,{akay:"GTrnXa5hwXGwgQnTBG28SHBubErMKm3f",children:[y(O,{center:"\u676D\u5DDE"}),y(O,{center:"\u4E0A\u6D77",children:({BMap:e,map:o,container:a})=>{}})]})}),{})}export{ee as default};
