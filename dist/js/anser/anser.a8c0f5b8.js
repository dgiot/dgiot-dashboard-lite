var e=function(){function e(e,r){for(var n=0;n<r.length;n++){var o=r[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(r,n,o){return n&&e(r.prototype,n),o&&e(r,o),r}}();var r=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],n=function(){function n(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,n),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0}return e(n,null,[{key:"escapeForHtml",value:function(e){return(new n).escapeForHtml(e)}},{key:"linkify",value:function(e){return(new n).linkify(e)}},{key:"ansiToHtml",value:function(e,r){return(new n).ansiToHtml(e,r)}},{key:"ansiToJson",value:function(e,r){return(new n).ansiToJson(e,r)}},{key:"ansiToText",value:function(e){return(new n).ansiToText(e)}}]),e(n,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var e=0;e<2;++e)for(var n=0;n<8;++n)this.PALETTE_COLORS.push(r[e][n].color);for(var o=[0,95,135,175,215,255],t=function(e,r,n){return o[e]+", "+o[r]+", "+o[n]},s=0;s<6;++s)for(var i=0;i<6;++i)for(var l=0;l<6;++l)this.PALETTE_COLORS.push(t(s,i,l));for(var a=8,c=0;c<24;++c,a+=10)this.PALETTE_COLORS.push(t(a,a,a))}},{key:"escapeForHtml",value:function(e){return e.replace(/[&<>]/gm,(function(e){return"&"==e?"&amp;":"<"==e?"&lt;":">"==e?"&gt;":""}))}},{key:"linkify",value:function(e){return e.replace(/(https?:\/\/[^\s]+)/gm,(function(e){return'<a href="'+e+'">'+e+"</a>"}))}},{key:"ansiToHtml",value:function(e,r){return this.process(e,r,!0)}},{key:"ansiToJson",value:function(e,r){return(r=r||{}).json=!0,r.clearLine=!1,this.process(e,r,!0)}},{key:"ansiToText",value:function(e){return this.process(e,{},!1)}},{key:"process",value:function(e,r,n){var o=this,t=e.split(/\033\[/),s=t.shift();null==r&&(r={}),r.clearLine=/\r/.test(e);var i=t.map((function(e){return o.processChunk(e,r,n)}));if(r&&r.json){var l=this.processChunkJson("");return l.content=s,l.clearLine=r.clearLine,i.unshift(l),r.remove_empty&&(i=i.filter((function(e){return!e.isEmpty()}))),i}return i.unshift(s),i.join("")}},{key:"processChunkJson",value:function(e,n,o){var t=(n=void 0===n?{}:n).use_classes=void 0!==n.use_classes&&n.use_classes,s=n.key=t?"class":"color",i={content:e,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,clearLine:n.clearLine,decoration:null,was_processed:!1,isEmpty:function(){return!i.content}},l=e.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!l)return i;i.content=l[4];var a=l[2].split(";");if(""!==l[1]||"m"!==l[3])return i;if(!o)return i;var c=this;for(c.decoration=null;a.length>0;){var u=a.shift(),f=parseInt(u);if(isNaN(f)||0===f)c.fg=c.bg=c.decoration=null;else if(1===f)c.decoration="bold";else if(2===f)c.decoration="dim";else if(3==f)c.decoration="italic";else if(4==f)c.decoration="underline";else if(5==f)c.decoration="blink";else if(7===f)c.decoration="reverse";else if(8===f)c.decoration="hidden";else if(9===f)c.decoration="strikethrough";else if(39==f)c.fg=null;else if(49==f)c.bg=null;else if(f>=30&&f<38)c.fg=r[0][f%10][s];else if(f>=90&&f<98)c.fg=r[1][f%10][s];else if(f>=40&&f<48)c.bg=r[0][f%10][s];else if(f>=100&&f<108)c.bg=r[1][f%10][s];else if(38===f||48===f){var h=38===f;if(a.length>=1){var g=a.shift();if("5"===g&&a.length>=1){var p=parseInt(a.shift());if(p>=0&&p<=255)if(t){var b=p>=16?"ansi-palette-"+p:r[p>7?1:0][p%8].class;h?c.fg=b:c.bg=b}else this.PALETTE_COLORS||c.setupPalette(),h?c.fg=this.PALETTE_COLORS[p]:c.bg=this.PALETTE_COLORS[p]}else if("2"===g&&a.length>=3){var v=parseInt(a.shift()),d=parseInt(a.shift()),y=parseInt(a.shift());if(v>=0&&v<=255&&d>=0&&d<=255&&y>=0&&y<=255){var _=v+", "+d+", "+y;t?h?(c.fg="ansi-truecolor",c.fg_truecolor=_):(c.bg="ansi-truecolor",c.bg_truecolor=_):h?c.fg=_:c.bg=_}}}}}return null===c.fg&&null===c.bg&&null===c.decoration||(i.fg=c.fg,i.bg=c.bg,i.fg_truecolor=c.fg_truecolor,i.bg_truecolor=c.bg_truecolor,i.decoration=c.decoration,i.was_processed=!0),i}},{key:"processChunk",value:function(e,r,n){var o=this;r=r||{};var t=this.processChunkJson(e,r,n);if(r.json)return t;if(t.isEmpty())return"";if(!t.was_processed)return t.content;var s=r.use_classes,i=[],l=[],a={},c=function(e){var r=[],n=void 0;for(n in e)e.hasOwnProperty(n)&&r.push("data-"+n+'="'+o.escapeForHtml(e[n])+'"');return r.length>0?" "+r.join(" "):""};return t.fg&&(s?(l.push(t.fg+"-fg"),null!==t.fg_truecolor&&(a["ansi-truecolor-fg"]=t.fg_truecolor,t.fg_truecolor=null)):i.push("color:rgb("+t.fg+")")),t.bg&&(s?(l.push(t.bg+"-bg"),null!==t.bg_truecolor&&(a["ansi-truecolor-bg"]=t.bg_truecolor,t.bg_truecolor=null)):i.push("background-color:rgb("+t.bg+")")),t.decoration&&(s?l.push("ansi-"+t.decoration):"bold"===t.decoration?i.push("font-weight:bold"):"dim"===t.decoration?i.push("opacity:0.5"):"italic"===t.decoration?i.push("font-style:italic"):"reverse"===t.decoration?i.push("filter:invert(100%)"):"hidden"===t.decoration?i.push("visibility:hidden"):"strikethrough"===t.decoration?i.push("text-decoration:line-through"):i.push("text-decoration:"+t.decoration)),s?'<span class="'+l.join(" ")+'"'+c(a)+">"+t.content+"</span>":'<span style="'+i.join(";")+'"'+c(a)+">"+t.content+"</span>"}}]),n}();export{n as l};
