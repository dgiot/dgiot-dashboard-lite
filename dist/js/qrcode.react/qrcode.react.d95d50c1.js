var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,a=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,l=(e,t)=>{for(var r in t||(t={}))o.call(t,r)&&a(e,r,t[r]);if(n)for(var r of n(t))i.call(t,r)&&a(e,r,t[r]);return e};import{r as c}from"../react/react.fab41096.js";import{b as u}from"../@arco-design/@arco-design.c1e19da8.js";import{g as f}from"../@antv/@antv.e579bdb9.js";import{Q as s,E as h}from"../qr.js/qr.js.5e333e20.js";var p=f(u),g=p.jsx,v=p.Fragment,d=p.jsxs;function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(r,!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j(e,t,r){return t&&C(e.prototype,t),r&&C(e,r),e}function S(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?x(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var k=c.exports,D=s,z=h;function L(e){for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n<2048?(t+=String.fromCharCode(192|n>>6),t+=String.fromCharCode(128|63&n)):n<55296||n>=57344?(t+=String.fromCharCode(224|n>>12),t+=String.fromCharCode(128|n>>6&63),t+=String.fromCharCode(128|63&n)):(r++,n=65536+((1023&n)<<10|1023&e.charCodeAt(r)),t+=String.fromCharCode(240|n>>18),t+=String.fromCharCode(128|n>>12&63),t+=String.fromCharCode(128|n>>6&63),t+=String.fromCharCode(128|63&n))}return t}var A={size:128,level:"L",bgColor:"#FFFFFF",fgColor:"#000000",includeMargin:!1};function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[];return e.forEach((function(e,n){var o=null;e.forEach((function(i,a){if(!i&&null!==o)return r.push("M".concat(o+t," ").concat(n+t,"h").concat(a-o,"v1H").concat(o+t,"z")),void(o=null);if(a!==e.length-1)i&&null===o&&(o=a);else{if(!i)return;null===o?r.push("M".concat(a+t,",").concat(n+t," h1v1H").concat(a+t,"z")):r.push("M".concat(o+t,",").concat(n+t," h").concat(a+1-o,"v1H").concat(o+t,"z"))}}))})),r.join("")}function R(e,t){return e.slice().map((function(e,r){return r<t.y||r>=t.y+t.h?e:e.map((function(e,r){return(r<t.x||r>=t.x+t.w)&&e}))}))}function I(e,t){var r=e.imageSettings,n=e.size,o=e.includeMargin;if(null==r)return null;var i=o?4:0,a=t.length+2*i,l=Math.floor(.1*n),c=a/n,u=(r.width||l)*c,f=(r.height||l)*c,s=null==r.x?t.length/2-u/2:r.x*c,h=null==r.y?t.length/2-f/2:r.y*c,p=null;if(r.excavate){var g=Math.floor(s),v=Math.floor(h);p={x:g,y:v,w:Math.ceil(u+s-g),h:Math.ceil(f+h-v)}}return{x:s,y:h,h:f,w:u,excavation:p}}var H=function(){try{(new Path2D).addPath(new Path2D)}catch(e){return!1}return!0}(),q=function(e){function t(){var e,r;w(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return E(x(r=S(this,(e=P(t)).call.apply(e,[this].concat(o)))),"_canvas",void 0),E(x(r),"_image",void 0),E(x(r),"state",{imgLoaded:!1}),E(x(r),"handleImageLoad",(function(){r.setState({imgLoaded:!0})})),r}return _(t,k.PureComponent),j(t,[{key:"componentDidMount",value:function(){this._image&&this._image.complete&&this.handleImageLoad(),this.update()}},{key:"componentWillReceiveProps",value:function(e){var t,r;(null===(t=this.props.imageSettings)||void 0===t?void 0:t.src)!==(null===(r=e.imageSettings)||void 0===r?void 0:r.src)&&this.setState({imgLoaded:!1})}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"update",value:function(){var e=this.props,t=e.value,r=e.size,n=e.level,o=e.bgColor,i=e.fgColor,a=e.includeMargin,l=e.imageSettings,c=new D(-1,z[n]);if(c.addData(L(t)),c.make(),null!=this._canvas){var u=this._canvas,f=u.getContext("2d");if(!f)return;var s=c.modules;if(null===s)return;var h=a?4:0,p=s.length+2*h,g=I(this.props,s);null!=l&&null!=g&&null!=g.excavation&&(s=R(s,g.excavation));var v=window.devicePixelRatio||1;u.height=u.width=r*v;var d=r/p*v;f.scale(d,d),f.fillStyle=o,f.fillRect(0,0,p,p),f.fillStyle=i,H?f.fill(new Path2D(F(s,h))):s.forEach((function(e,t){e.forEach((function(e,r){e&&f.fillRect(r+h,t+h,1,1)}))})),this.state.imgLoaded&&this._image&&null!=g&&f.drawImage(this._image,g.x+h,g.y+h,g.w,g.h)}}},{key:"render",value:function(){var e=this,t=this.props;t.value;var r=t.size;t.level,t.bgColor,t.fgColor;var n=t.style;t.includeMargin;var o=t.imageSettings,i=O(t,["value","size","level","bgColor","fgColor","style","includeMargin","imageSettings"]),a=b({height:r,width:r},n),c=null,u=o&&o.src;return null!=o&&null!=u&&(c=g("img",{src:u,style:{display:"none"},onLoad:this.handleImageLoad,ref:function(t){return e._image=t}})),d(v,{children:[g("canvas",l({style:a,height:r,width:r,ref:function(t){return e._canvas=t}},i)),c]})}}]),t}();E(q,"defaultProps",A);var T=function(e){function n(){return w(this,n),S(this,P(n).apply(this,arguments))}return _(n,k.PureComponent),j(n,[{key:"render",value:function(){var e=this.props,n=e.value,o=e.size,i=e.level,a=e.bgColor,c=e.fgColor,u=e.includeMargin,f=e.imageSettings,s=O(e,["value","size","level","bgColor","fgColor","includeMargin","imageSettings"]),h=new D(-1,z[i]);h.addData(L(n)),h.make();var p=h.modules;if(null===p)return null;var v=u?4:0,y=p.length+2*v,m=I(this.props,p),b=null;null!=f&&null!=m&&(null!=m.excavation&&(p=R(p,m.excavation)),b=g("image",{xlinkHref:f.src,height:m.h,width:m.w,x:m.x+v,y:m.y+v,preserveAspectRatio:"none"}));var w,C,j=F(p,v);return d("svg",(w=l({shapeRendering:"crispEdges",height:o,width:o,viewBox:"0 0 ".concat(y," ").concat(y)},s),C={children:[g("path",{fill:a,d:"M0,0 h".concat(y,"v").concat(y,"H0z")}),g("path",{fill:c,d:j}),b]},t(w,r(C))))}}]),n}();E(T,"defaultProps",A);var B=function(e){var t=e.renderAs,r=O(e,["renderAs"]);return g("svg"===t?T:q,l({},r))};B.defaultProps=b({renderAs:"canvas"},A);var Q=B;export{Q as l};
