import{g as e}from"../@antv/@antv.e579bdb9.js";import{f as t,g as n,_ as r,b as i,h as a,i as u,j as s}from"../@babel/@babel.531a568e.js";import{r as o}from"../react/react.fab41096.js";import{a as c}from"../classnames/classnames.29e4295e.js";import{i as l,w as f,c as d,a as v,b as m,K as p}from"../rc-util/rc-util.296518f6.js";function g(){return"function"==typeof BigInt}function h(e){var t=e.trim(),n=t.startsWith("-");n&&(t=t.slice(1)),(t=t.replace(/(\.\d*[^0])0*$/,"$1").replace(/\.0*$/,"").replace(/^0+/,"")).startsWith(".")&&(t="0".concat(t));var r=t||"0",i=r.split("."),a=i[0]||"0",u=i[1]||"0";"0"===a&&"0"===u&&(n=!1);var s=n?"-":"";return{negative:n,negativeStr:s,trimStr:r,integerStr:a,decimalStr:u,fullStr:"".concat(s).concat(r)}}function N(e){var t=String(e);return!Number.isNaN(Number(t))&&t.includes("e")}function b(e){var t=String(e);if(N(e)){var n=Number(t.slice(t.indexOf("e-")+2)),r=t.match(/\.(\d+)/);return(null==r?void 0:r[1])&&(n+=r[1].length),n}return t.includes(".")&&y(t)?t.length-t.indexOf(".")-1:0}function S(e){var t=String(e);if(N(e)){if(e>Number.MAX_SAFE_INTEGER)return String(g()?BigInt(e).toString():Number.MAX_SAFE_INTEGER);if(e<Number.MIN_SAFE_INTEGER)return String(g()?BigInt(e).toString():Number.MIN_SAFE_INTEGER);t=e.toFixed(b(t))}return h(t).fullStr}function y(e){return"number"==typeof e?!Number.isNaN(e):!!e&&(/^\s*-?\d+(\.\d+)?\s*$/.test(e)||/^\s*-?\d+\.\s*$/.test(e)||/^\s*-?\.\d+\s*$/.test(e))}var E=function(){function e(t){n(this,e),this.origin="",this.number=void 0,this.empty=void 0,(t||0===t)&&String(t).trim()?(this.origin=String(t),this.number=Number(t)):this.empty=!0}return t(e,[{key:"negate",value:function(){return new e(-this.toNumber())}},{key:"add",value:function(t){if(this.isInvalidate())return new e(t);var n=Number(t);if(Number.isNaN(n))return this;var r=this.number+n;if(r>Number.MAX_SAFE_INTEGER)return new e(Number.MAX_SAFE_INTEGER);if(r<Number.MIN_SAFE_INTEGER)return new e(Number.MIN_SAFE_INTEGER);var i=Math.max(b(this.number),b(n));return new e(r.toFixed(i))}},{key:"isEmpty",value:function(){return this.empty}},{key:"isNaN",value:function(){return Number.isNaN(this.number)}},{key:"isInvalidate",value:function(){return this.isEmpty()||this.isNaN()}},{key:"equals",value:function(e){return this.toNumber()===(null==e?void 0:e.toNumber())}},{key:"lessEquals",value:function(e){return this.add(e.negate().toString()).toNumber()<=0}},{key:"toNumber",value:function(){return this.number}},{key:"toString",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?this.isInvalidate()?"":S(this.number):this.origin}}]),e}(),x=function(){function e(t){if(n(this,e),this.origin="",this.negative=void 0,this.integer=void 0,this.decimal=void 0,this.decimalLen=void 0,this.empty=void 0,this.nan=void 0,(t||0===t)&&String(t).trim())if(this.origin=String(t),"-"!==t){var r=t;if(N(r)&&(r=Number(r)),y(r="string"==typeof r?r:S(r))){var i=h(r);this.negative=i.negative;var a=i.trimStr.split(".");this.integer=BigInt(a[0]);var u=a[1]||"0";this.decimal=BigInt(u),this.decimalLen=u.length}else this.nan=!0}else this.nan=!0;else this.empty=!0}return t(e,[{key:"getMark",value:function(){return this.negative?"-":""}},{key:"getIntegerStr",value:function(){return this.integer.toString()}},{key:"getDecimalStr",value:function(){return this.decimal.toString().padStart(this.decimalLen,"0")}},{key:"alignDecimal",value:function(e){var t="".concat(this.getMark()).concat(this.getIntegerStr()).concat(this.getDecimalStr().padEnd(e,"0"));return BigInt(t)}},{key:"negate",value:function(){var t=new e(this.toString());return t.negative=!t.negative,t}},{key:"add",value:function(t){if(this.isInvalidate())return new e(t);var n=new e(t);if(n.isInvalidate())return this;var r=Math.max(this.getDecimalStr().length,n.getDecimalStr().length),i=h((this.alignDecimal(r)+n.alignDecimal(r)).toString()),a=i.negativeStr,u=i.trimStr,s="".concat(a).concat(u.padStart(r+1,"0"));return new e("".concat(s.slice(0,-r),".").concat(s.slice(-r)))}},{key:"isEmpty",value:function(){return this.empty}},{key:"isNaN",value:function(){return this.nan}},{key:"isInvalidate",value:function(){return this.isEmpty()||this.isNaN()}},{key:"equals",value:function(e){return this.toString()===(null==e?void 0:e.toString())}},{key:"lessEquals",value:function(e){return this.add(e.negate().toString()).toNumber()<=0}},{key:"toNumber",value:function(){return this.isNaN()?NaN:Number(this.toString())}},{key:"toString",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?this.isInvalidate()?"":h("".concat(this.getMark()).concat(this.getIntegerStr(),".").concat(this.getDecimalStr())).fullStr:this.origin}}]),e}();function I(e){return g()?new x(e):new E(e)}function w(e,t,n){if(""===e)return"";var r=h(e),i=r.negativeStr,a=r.integerStr,u=r.decimalStr,s="".concat(t).concat(u),o="".concat(i).concat(a);if(n>=0){var c=Number(u[n]);return c>=5?w(I(e).add("".concat(i,"0.").concat("0".repeat(n)).concat(10-c)).toString(),t,n):0===n?o:"".concat(o).concat(t).concat(u.padEnd(n,"0").slice(0,n))}return".0"===s?o:"".concat(o).concat(s)}function k(e){var t=e.prefixCls,n=e.upNode,a=e.downNode,u=e.upDisabled,s=e.downDisabled,f=e.onStep,d=o.exports.useRef(),v=o.exports.useRef();v.current=f;var m=function(e,t){e.preventDefault(),v.current(t),d.current=setTimeout((function e(){v.current(t),d.current=setTimeout(e,200)}),600)},p=function(){clearTimeout(d.current)};if(o.exports.useEffect((function(){return p}),[]),l())return null;var g="".concat(t,"-handler"),h=c(g,"".concat(g,"-up"),r({},"".concat(g,"-up-disabled"),u)),N=c(g,"".concat(g,"-down"),r({},"".concat(g,"-down-disabled"),s)),b={unselectable:"on",role:"button",onMouseUp:p,onMouseLeave:p};return o.exports.createElement("div",{className:"".concat(g,"-wrap")},o.exports.createElement("span",i({},b,{onMouseDown:function(e){m(e,!0)},"aria-label":"Increase Value","aria-disabled":u,className:h}),n||o.exports.createElement("span",{unselectable:"on",className:"".concat(t,"-handler-up-inner")})),o.exports.createElement("span",i({},b,{onMouseDown:function(e){m(e,!1)},"aria-label":"Decrease Value","aria-disabled":s,className:N}),a||o.exports.createElement("span",{unselectable:"on",className:"".concat(t,"-handler-down-inner")})))}var M=d()?o.exports.useLayoutEffect:o.exports.useEffect;function _(e,t){var n=o.exports.useRef(!1);M((function(){if(n.current)return e();n.current=!0}),t)}var R=["prefixCls","className","style","min","max","step","defaultValue","value","disabled","readOnly","upHandler","downHandler","keyboard","controls","stringMode","parser","formatter","precision","decimalSeparator","onChange","onInput","onPressEnter","onStep"],D=function(e,t){return e||t.isEmpty()?t.toString():t.toNumber()},T=function(e){var t=I(e);return t.isInvalidate()?null:t},C=o.exports.forwardRef((function(e,t){var n,l=e.prefixCls,d=void 0===l?"rc-input-number":l,g=e.className,h=e.style,N=e.min,E=e.max,x=e.step,M=void 0===x?1:x,C=e.defaultValue,A=e.value,F=e.disabled,q=e.readOnly,O=e.upHandler,j=e.downHandler,G=e.keyboard,B=e.controls,P=void 0===B||B,$=e.stringMode,L=e.parser,W=e.formatter,H=e.precision,U=e.decimalSeparator,V=e.onChange,X=e.onInput,K=e.onPressEnter,z=e.onStep,J=a(e,R),Q="".concat(d,"-input"),Y=o.exports.useRef(null),Z=o.exports.useState(!1),ee=u(Z,2),te=ee[0],ne=ee[1],re=o.exports.useRef(!1),ie=o.exports.useRef(!1),ae=o.exports.useState((function(){return I(null!=A?A:C)})),ue=u(ae,2),se=ue[0],oe=ue[1];var ce=o.exports.useCallback((function(e,t){if(!t)return H>=0?H:Math.max(b(e),b(M))}),[H,M]),le=o.exports.useCallback((function(e){var t=String(e);if(L)return L(t);var n=t;return U&&(n=n.replace(U,".")),n.replace(/[^\w.-]+/g,"")}),[L,U]),fe=o.exports.useRef(""),de=o.exports.useCallback((function(e,t){if(W)return W(e,{userTyping:t,input:String(fe.current)});var n="number"==typeof e?S(e):e;if(!t){var r=ce(n,t);if(y(n)&&(U||r>=0))n=w(n,U||".",r)}return n}),[W,ce,U]),ve=o.exports.useState((function(){var e=null!=C?C:A;return se.isInvalidate()&&["string","number"].includes(s(e))?Number.isNaN(e)?"":e:de(se.toString(),!1)})),me=u(ve,2),pe=me[0],ge=me[1];function he(e,t){ge(de(e.isInvalidate()?e.toString(!1):e.toString(!t),t))}fe.current=pe;var Ne,be,Se,ye,Ee,xe=o.exports.useMemo((function(){return T(E)}),[E]),Ie=o.exports.useMemo((function(){return T(N)}),[N]),we=o.exports.useMemo((function(){return!(!xe||!se||se.isInvalidate())&&xe.lessEquals(se)}),[xe,se]),ke=o.exports.useMemo((function(){return!(!Ie||!se||se.isInvalidate())&&se.lessEquals(Ie)}),[Ie,se]),Me=(Ne=Y.current,be=te,Se=o.exports.useRef(null),[function(){try{var e=Ne.selectionStart,t=Ne.selectionEnd,n=Ne.value,r=n.substring(0,e),i=n.substring(t);Se.current={start:e,end:t,value:n,beforeTxt:r,afterTxt:i}}catch(a){}},function(){if(Ne&&Se.current&&be)try{var e=Ne.value,t=Se.current,n=t.beforeTxt,r=t.afterTxt,i=t.start,a=e.length;if(e.endsWith(r))a=e.length-Se.current.afterTxt.length;else if(e.startsWith(n))a=n.length;else{var u=n[i-1],s=e.indexOf(u,i-1);-1!==s&&(a=s+1)}Ne.setSelectionRange(a,a)}catch(o){f(!1,"Something warning of cursor restore. Please fire issue about this: ".concat(o.message))}}]),_e=u(Me,2),Re=_e[0],De=_e[1],Te=function(e){return xe&&!e.lessEquals(xe)?xe:Ie&&!Ie.lessEquals(e)?Ie:null},Ce=function(e){return!Te(e)},Ae=function(e,t){var n,r=e,i=Ce(r)||r.isEmpty();if(r.isEmpty()||t||(r=Te(r)||r,i=!0),!q&&!F&&i){var a=r.toString(),u=ce(a,t);return u>=0&&(r=I(w(a,".",u))),r.equals(se)||(n=r,void 0===A&&oe(n),null==V||V(r.isEmpty()?null:D($,r)),void 0===A&&he(r,t)),r}return se},Fe=(ye=o.exports.useRef(0),Ee=function(){v.cancel(ye.current)},o.exports.useEffect((function(){return Ee}),[]),function(e){Ee(),ye.current=v((function(){e()}))}),qe=function e(t){if(Re(),ge(t),!ie.current){var n=I(le(t));n.isNaN()||Ae(n,!0)}null==X||X(t),Fe((function(){var n=t;L||(n=t.replace(/ã€‚/g,".")),n!==t&&e(n)}))},Oe=function(e){var t;if(!(e&&we||!e&&ke)){re.current=!1;var n=I(M);e||(n=n.negate());var r=(se||I(0)).add(n.toString()),i=Ae(r,!1);null==z||z(D($,i),{offset:M,type:e?"up":"down"}),null===(t=Y.current)||void 0===t||t.focus()}},je=function(e){var t=I(le(pe)),n=t;n=t.isNaN()?se:Ae(t,e),void 0!==A?he(se,!1):n.isNaN()||he(n,!1)};return _((function(){se.isInvalidate()||he(se,!1)}),[H]),_((function(){var e=I(A);oe(e);var t=I(le(pe));e.equals(t)&&re.current&&!W||he(e,re.current)}),[A]),_((function(){W&&De()}),[pe]),o.exports.createElement("div",{className:c(d,g,(n={},r(n,"".concat(d,"-focused"),te),r(n,"".concat(d,"-disabled"),F),r(n,"".concat(d,"-readonly"),q),r(n,"".concat(d,"-not-a-number"),se.isNaN()),r(n,"".concat(d,"-out-of-range"),!se.isInvalidate()&&!Ce(se)),n)),style:h,onFocus:function(){ne(!0)},onBlur:function(){je(!1),ne(!1),re.current=!1},onKeyDown:function(e){var t=e.which;re.current=!0,t===p.ENTER&&(ie.current||(re.current=!1),je(!1),null==K||K(e)),!1!==G&&!ie.current&&[p.UP,p.DOWN].includes(t)&&(Oe(p.UP===t),e.preventDefault())},onKeyUp:function(){re.current=!1},onCompositionStart:function(){ie.current=!0},onCompositionEnd:function(){ie.current=!1,qe(Y.current.value)}},P&&o.exports.createElement(k,{prefixCls:d,upNode:O,downNode:j,upDisabled:we,downDisabled:ke,onStep:Oe}),o.exports.createElement("div",{className:"".concat(Q,"-wrap")},o.exports.createElement("input",i({autoComplete:"off",role:"spinbutton","aria-valuemin":N,"aria-valuemax":E,"aria-valuenow":se.isInvalidate()?null:se.toString(),step:M},J,{ref:m(Y,t),className:Q,value:pe,onChange:function(e){qe(e.target.value)},disabled:F,readOnly:q}))))}));C.displayName="InputNumber";var A=e(Object.freeze(Object.defineProperty({__proto__:null,default:C},Symbol.toStringTag,{value:"Module"})));export{A as r};
