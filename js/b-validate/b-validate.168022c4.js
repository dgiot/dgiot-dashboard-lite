import{i as t}from"../lodash.isequal/lodash.isequal.b5c40efb.js";var e=Object.prototype.toString;function i(t){return"[object Array]"===e.call(t)}function o(t){return"[object Object]"===e.call(t)}function r(t){return"[object String]"===e.call(t)}function n(t){return null==t||""===t}function s(t){return i(t)&&!t.length}var a=function(t,e){o(e)&&r(t)&&e.trim?this.obj=t.trim():o(e)&&e.ignoreEmptyString&&""===t?this.obj=void 0:this.obj=t,this.message=e.message,this.type=e.type,this.error=null},h={not:{configurable:!0},isRequired:{configurable:!0},end:{configurable:!0}};h.not.get=function(){return this._not=!this._not,this},h.isRequired.get=function(){return(n(this.obj)||s(this.obj))&&(this.error={value:this.obj,type:this.type,requiredError:!0,message:this.message||(this._not?"[NOT MODE]:":"")+this.type+" is required"}),this},h.end.get=function(){return this.error},a.prototype.addError=function(t){!this.error&&t&&(this.error={value:this.obj,type:this.type,message:this.message||(o(t)?t:(this._not?"[NOT MODE]:":"")+t)})},a.prototype.validate=function(t,e){return(this._not?t:!t)&&this.addError(e),this},a.prototype.collect=function(t){t&&t(this.error)},Object.defineProperties(a.prototype,h);var c=function(t){function e(e,i){t.call(this,e,Object.assign({},i,{type:"string"})),this.validate(!i||!i.strict||r(this.obj),"Expect string type but got "+typeof this.obj)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={uppercase:{configurable:!0},lowercase:{configurable:!0}};return e.prototype.maxLength=function(t){return this.obj?this.validate(this.obj.length<=t,"Expect max length "+t+" but got "+this.obj.length):this},e.prototype.minLength=function(t){return this.obj?this.validate(this.obj.length>=t,"Expect min length "+t+" but got "+this.obj.length):this},e.prototype.length=function(t){return this.obj?this.validate(this.obj.length===t,"Expect length "+t+" but got "+this.obj.length):this},e.prototype.match=function(t){var e=t instanceof RegExp;return e&&(t.lastIndex=0),this.validate(void 0===this.obj||e&&t.test(this.obj),"`"+this.obj+"` is not match pattern "+t)},i.uppercase.get=function(){return this.obj?this.validate(this.obj.toUpperCase()===this.obj,"Expect `"+this.obj+"` to be uppercased"):this},i.lowercase.get=function(){return this.obj?this.validate(this.obj.toLowerCase()===this.obj,"Expect `"+this.obj+"` to be lowercased"):this},Object.defineProperties(e.prototype,i),e}(a),u=function(t){function i(i,o){t.call(this,i,Object.assign({},o,{type:"number"})),this.validate(!o||!o.strict||function(t){return"[object Number]"===e.call(t)&&t==t}(this.obj),"Expect number type but got "+typeof this.obj)}t&&(i.__proto__=t),i.prototype=Object.create(t&&t.prototype),i.prototype.constructor=i;var o={positive:{configurable:!0},negative:{configurable:!0}};return i.prototype.min=function(t){return n(this.obj)?this:this.validate(this.obj>=t,"`"+this.obj+"` is not greater than `"+t+"`")},i.prototype.max=function(t){return n(this.obj)?this:this.validate(this.obj<=t,"`"+this.obj+"` is not less than `"+t+"`")},i.prototype.equal=function(t){return n(this.obj)?this:this.validate(this.obj===t,"`"+this.obj+"` is not equal to `"+t+"`")},i.prototype.range=function(t,e){return n(this.obj)?this:this.validate(this.obj>=t&&this.obj<=e,"`"+this.obj+"` is not in range `"+t+" ~ "+e+"`")},o.positive.get=function(){return n(this.obj)?this:this.validate(this.obj>0,"Expect number to be positive, but got `"+this.obj+"`")},o.negative.get=function(){return n(this.obj)?this:this.validate(this.obj<0,"Expect number to be negative, but got `"+this.obj+"`")},Object.defineProperties(i.prototype,o),i}(a),p=function(e){function o(t,o){e.call(this,t,Object.assign({},o,{type:"array"})),this.validate(!o||!o.strict||i(this.obj),"Expect array type but got `"+this.obj+"`")}e&&(o.__proto__=e),o.prototype=Object.create(e&&e.prototype),o.prototype.constructor=o;var r={empty:{configurable:!0}};return o.prototype.length=function(t){return this.obj?this.validate(this.obj.length===t,"Expect array length "+t+" but got "+this.obj.length):this},o.prototype.minLength=function(t){return this.obj?this.validate(this.obj.length>=t,"Expect min array length "+t+" but got "+this.obj.length):this},o.prototype.maxLength=function(t){return this.obj?this.validate(this.obj.length<=t,"Expect max array length "+t+" but got "+this.obj.length):this},o.prototype.includes=function(t){var e=this;return this.obj?this.validate(t.every((function(t){return-1!==e.obj.indexOf(t)})),JSON.stringify(this.obj)+" is not includes "+JSON.stringify(t)):this},o.prototype.deepEqual=function(e){return this.obj?this.validate(t(this.obj,e),JSON.stringify(this.obj)+" is not deep equal with "+JSON.stringify(e)):this},r.empty.get=function(){return this.validate(s(this.obj),"Expect empty array but got "+JSON.stringify(this.obj))},Object.defineProperties(o.prototype,r),o}(a),b=function(e){function i(t,i){e.call(this,t,Object.assign({},i,{type:"object"})),this.validate(!i||!i.strict||o(this.obj),"Expect object type but got `"+this.obj+"`")}e&&(i.__proto__=e),i.prototype=Object.create(e&&e.prototype),i.prototype.constructor=i;var r={empty:{configurable:!0}};return i.prototype.deepEqual=function(e){return this.obj?this.validate(t(this.obj,e),JSON.stringify(this.obj)+" is not deep equal with "+JSON.stringify(e)):this},i.prototype.hasKeys=function(t){var e=this;return this.obj?this.validate(t.every((function(t){return e.obj[t]})),JSON.stringify(this.obj)+" is not has keys "+t):this},r.empty.get=function(){return this.validate(o(t=this.obj)&&!Object.keys(t).length,"Expect empty object but got "+JSON.stringify(this.obj));var t},Object.defineProperties(i.prototype,r),i}(a),l=function(t){function i(i,o){t.call(this,i,Object.assign({},o,{type:"boolean"})),this.validate(!o||!o.strict||function(t){return"[object Boolean]"===e.call(t)}(this.obj),"Expect boolean type but got "+typeof this.obj)}t&&(i.__proto__=t),i.prototype=Object.create(t&&t.prototype),i.prototype.constructor=i;var o={true:{configurable:!0},false:{configurable:!0}};return o.true.get=function(){return this.validate(!0===this.obj,"Expect true but got false")},o.false.get=function(){return this.validate(!1===this.obj,"Expect false but got true")},Object.defineProperties(i.prototype,o),i}(a),f=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,j=new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),g=/^(2(5[0-5]{1}|[0-4]\d{1})|[0-1]?\d{1,2})(\.(2(5[0-5]{1}|[0-4]\d{1})|[0-1]?\d{1,2})){3}$/,y=function(t){function e(e,i){t.call(this,e,Object.assign({},i,{type:"type"}))}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={email:{configurable:!0},url:{configurable:!0},ip:{configurable:!0}};return i.email.get=function(){return this.validate(void 0===this.obj||f.test(this.obj),"Expect type email but got `"+this.obj+"`")},i.url.get=function(){return this.validate(void 0===this.obj||j.test(this.obj),"Expect type url but got `"+this.obj+"`")},i.ip.get=function(){return this.validate(void 0===this.obj||g.test(this.obj),"Expect type ip but got `"+this.obj+"`")},Object.defineProperties(e.prototype,i),e}(a),d=function(t){function e(e,i){t.call(this,e,Object.assign({},i,{type:"custom"}))}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={validate:{configurable:!0}};return i.validate.get=function(){var t=this;return function(e,i){var o;if(e)return(o=e(t.obj,t.addError.bind(t)))&&o.then?(i&&o.then((function(){i&&i(t.error)}),(function(t){})),[o,t]):(i&&i(t.error),this.error)}},Object.defineProperties(e.prototype,i),e}(a),v=function(t,e){this.string=new c(t,e),this.number=new u(t,e),this.array=new p(t,e),this.object=new b(t,e),this.boolean=new l(t,e),this.type=new y(t,e),this.custom=new d(t,e)},m=function(t,e){void 0===e&&(e={}),this.schema=t,this.options=e};m.prototype.validate=function(t,e){var r=this;if(o(t)){var n=[],s=null;this.schema&&Object.keys(this.schema).forEach((function(e){if(i(r.schema[e]))for(var o=function(i){var o=r.schema[e][i],h=o.type,c=o.message,u=void 0;if(!h&&!o.validator)throw"You must specify a type to field "+e+"!";if("email"===h||"url"===h||"ip"===h)u=new v(t[e],Object.assign({},r.options,{message:c})).type[h];else{if(o.validator)return u=new v(t[e],Object.assign({},r.options,{message:c})).custom.validate(o.validator),void("[object Array]"===Object.prototype.toString.call(u)&&u[0].then?n.push({function:u[0],_this:u[1],key:e}):u&&a(e,u));u=new v(t[e],Object.assign({},r.options,{message:c}))[h]}if(Object.keys(o).forEach((function(t){o.required&&(u=u.isRequired),"message"!==t&&u[t]&&o[t]&&"object"==typeof u[t]&&(u=u[t]),u[t]&&void 0!==o[t]&&"function"==typeof u[t]&&(u=u[t](o[t]))})),u.collect((function(t){t&&a(e,t)})),s)return"break"},h=0;h<r.schema[e].length;h++){if("break"===o(h))break}})),n.length>0?Promise.all(n.map((function(t){return t.function}))).then((function(){n.forEach((function(t){t._this.error&&a(t.key,t._this.error)})),e&&e(s)})):e&&e(s)}function a(t,e){s||(s={}),s[t]&&!e.requiredError||(s[t]=e)}};export{m as S};
