import{r as e}from"../react/react.e5edc743.js";import{Q as t,E as n}from"../qr.js/qr.js.ee070c5d.js";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(n,!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?g(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=e.exports,y=t,b=n;function w(e){for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r<2048?(t+=String.fromCharCode(192|r>>6),t+=String.fromCharCode(128|63&r)):r<55296||r>=57344?(t+=String.fromCharCode(224|r>>12),t+=String.fromCharCode(128|r>>6&63),t+=String.fromCharCode(128|63&r)):(n++,r=65536+((1023&r)<<10|1023&e.charCodeAt(n)),t+=String.fromCharCode(240|r>>18),t+=String.fromCharCode(128|r>>12&63),t+=String.fromCharCode(128|r>>6&63),t+=String.fromCharCode(128|63&r))}return t}var C={size:128,level:"L",bgColor:"#FFFFFF",fgColor:"#000000",includeMargin:!1};function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[];return e.forEach((function(e,r){var o=null;e.forEach((function(a,i){if(!a&&null!==o)return n.push("M".concat(o+t," ").concat(r+t,"h").concat(i-o,"v1H").concat(o+t,"z")),void(o=null);if(i!==e.length-1)a&&null===o&&(o=i);else{if(!a)return;null===o?n.push("M".concat(i+t,",").concat(r+t," h1v1H").concat(i+t,"z")):n.push("M".concat(o+t,",").concat(r+t," h").concat(i+1-o,"v1H").concat(o+t,"z"))}}))})),n.join("")}function S(e,t){return e.slice().map((function(e,n){return n<t.y||n>=t.y+t.h?e:e.map((function(e,n){return(n<t.x||n>=t.x+t.w)&&e}))}))}function j(e,t){var n=e.imageSettings,r=e.size,o=e.includeMargin;if(null==n)return null;var a=o?4:0,i=t.length+2*a,l=Math.floor(.1*r),c=i/r,u=(n.width||l)*c,f=(n.height||l)*c,s=null==n.x?t.length/2-u/2:n.x*c,h=null==n.y?t.length/2-f/2:n.y*c,g=null;if(n.excavate){var p=Math.floor(s),v=Math.floor(h);g={x:p,y:v,w:Math.ceil(u+s-p),h:Math.ceil(f+h-v)}}return{x:s,y:h,h:f,w:u,excavation:g}}var P=function(){try{(new Path2D).addPath(new Path2D)}catch(e){return!1}return!0}(),x=function(e){function t(){var e,n;c(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return d(g(n=s(this,(e=h(t)).call.apply(e,[this].concat(o)))),"_canvas",void 0),d(g(n),"_image",void 0),d(g(n),"state",{imgLoaded:!1}),d(g(n),"handleImageLoad",(function(){n.setState({imgLoaded:!0})})),n}return p(t,m.PureComponent),f(t,[{key:"componentDidMount",value:function(){this._image&&this._image.complete&&this.handleImageLoad(),this.update()}},{key:"componentWillReceiveProps",value:function(e){var t,n;(null===(t=this.props.imageSettings)||void 0===t?void 0:t.src)!==(null===(n=e.imageSettings)||void 0===n?void 0:n.src)&&this.setState({imgLoaded:!1})}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"update",value:function(){var e=this.props,t=e.value,n=e.size,r=e.level,o=e.bgColor,a=e.fgColor,i=e.includeMargin,l=e.imageSettings,c=new y(-1,b[r]);if(c.addData(w(t)),c.make(),null!=this._canvas){var u=this._canvas,f=u.getContext("2d");if(!f)return;var s=c.modules;if(null===s)return;var h=i?4:0,g=s.length+2*h,p=j(this.props,s);null!=l&&null!=p&&null!=p.excavation&&(s=S(s,p.excavation));var v=window.devicePixelRatio||1;u.height=u.width=n*v;var d=n/g*v;f.scale(d,d),f.fillStyle=o,f.fillRect(0,0,g,g),f.fillStyle=a,P?f.fill(new Path2D(O(s,h))):s.forEach((function(e,t){e.forEach((function(e,n){e&&f.fillRect(n+h,t+h,1,1)}))})),this.state.imgLoaded&&this._image&&null!=p&&f.drawImage(this._image,p.x+h,p.y+h,p.w,p.h)}}},{key:"render",value:function(){var e=this,t=this.props;t.value;var n=t.size;t.level,t.bgColor,t.fgColor;var r=t.style;t.includeMargin;var a=t.imageSettings,c=l(t,["value","size","level","bgColor","fgColor","style","includeMargin","imageSettings"]),u=i({height:n,width:n},r),f=null,s=a&&a.src;return null!=a&&null!=s&&(f=m.createElement("img",{src:s,style:{display:"none"},onLoad:this.handleImageLoad,ref:function(t){return e._image=t}})),m.createElement(m.Fragment,null,m.createElement("canvas",o({style:u,height:n,width:n,ref:function(t){return e._canvas=t}},c)),f)}}]),t}();d(x,"defaultProps",C);var E=function(e){function t(){return c(this,t),s(this,h(t).apply(this,arguments))}return p(t,m.PureComponent),f(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=e.size,r=e.level,a=e.bgColor,i=e.fgColor,c=e.includeMargin,u=e.imageSettings,f=l(e,["value","size","level","bgColor","fgColor","includeMargin","imageSettings"]),s=new y(-1,b[r]);s.addData(w(t)),s.make();var h=s.modules;if(null===h)return null;var g=c?4:0,p=h.length+2*g,v=j(this.props,h),d=null;null!=u&&null!=v&&(null!=v.excavation&&(h=S(h,v.excavation)),d=m.createElement("image",{xlinkHref:u.src,height:v.h,width:v.w,x:v.x+g,y:v.y+g,preserveAspectRatio:"none"}));var C=O(h,g);return m.createElement("svg",o({shapeRendering:"crispEdges",height:n,width:n,viewBox:"0 0 ".concat(p," ").concat(p)},f),m.createElement("path",{fill:a,d:"M0,0 h".concat(p,"v").concat(p,"H0z")}),m.createElement("path",{fill:i,d:C}),d)}}]),t}();d(E,"defaultProps",C);var _=function(e){var t=e.renderAs,n=l(e,["renderAs"]),r="svg"===t?E:x;return m.createElement(r,n)};_.defaultProps=i({renderAs:"canvas"},C);var M=_;export{M as l};
