import{g as e}from"../@antv/@antv.69345435.js";import{r,R as t}from"../react/react.e5edc743.js";import{P as n}from"../prop-types/prop-types.1fb3bfd4.js";import{f as o}from"../file-selector/file-selector.2c705dcf.js";import{_ as i}from"../attr-accept/attr-accept.fec1e0ad.js";function a(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?a(Object(t),!0).forEach((function(r){u(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function u(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function l(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,i=[],a=!0,c=!1;try{for(t=t.call(e);!(a=(n=t.next()).done)&&(i.push(n.value),!r||i.length!==r);a=!0);}catch(u){c=!0,o=u}finally{try{a||null==t.return||t.return()}finally{if(c)throw o}}return i}(e,r)||function(e,r){if(!e)return;if("string"==typeof e)return s(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return s(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var f={FileInvalidType:"file-invalid-type",FileTooLarge:"file-too-large",FileTooSmall:"file-too-small",TooManyFiles:"too-many-files"},p=function(e){e=Array.isArray(e)&&1===e.length?e[0]:e;var r=Array.isArray(e)?"one of ".concat(e.join(", ")):e;return{code:"file-invalid-type",message:"File type must be ".concat(r)}},g=function(e){return{code:"file-too-large",message:"File is larger than ".concat(e," ").concat(1===e?"byte":"bytes")}},d=function(e){return{code:"file-too-small",message:"File is smaller than ".concat(e," ").concat(1===e?"byte":"bytes")}},y={code:"too-many-files",message:"Too many files"};function v(e,r){var t="application/x-moz-file"===e.type||i(e,r);return[t,t?null:p(r)]}function b(e,r,t){if(m(e.size))if(m(r)&&m(t)){if(e.size>t)return[!1,g(t)];if(e.size<r)return[!1,d(r)]}else{if(m(r)&&e.size<r)return[!1,d(r)];if(m(t)&&e.size>t)return[!1,g(t)]}return[!0,null]}function m(e){return null!=e}function D(e){var r=e.files,t=e.accept,n=e.minSize,o=e.maxSize,i=e.multiple,a=e.maxFiles;return!(!i&&r.length>1||i&&a>=1&&r.length>a)&&r.every((function(e){var r=l(v(e,t),1)[0],i=l(b(e,n,o),1)[0];return r&&i}))}function h(e){return"function"==typeof e.isPropagationStopped?e.isPropagationStopped():void 0!==e.cancelBubble&&e.cancelBubble}function O(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,(function(e){return"Files"===e||"application/x-moz-file"===e})):!!e.target&&!!e.target.files}function F(e){e.preventDefault()}function j(e){return-1!==e.indexOf("MSIE")||-1!==e.indexOf("Trident/")}function x(e){return-1!==e.indexOf("Edge/")}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator.userAgent;return j(e)||x(e)}function A(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return r.some((function(r){return!h(e)&&r&&r.apply(void 0,[e].concat(n)),h(e)}))}}function E(){return"showOpenFilePicker"in window}function S(e){return e="string"==typeof e?e.split(","):e,[{description:"everything",accept:Array.isArray(e)?e.filter((function(e){return"audio/*"===e||"video/*"===e||"image/*"===e||"text/*"===e||/\w+\/[-+.\w]+/g.test(e)})).reduce((function(e,r){return c(c({},e),{},u({},r,[]))}),{}):{}}]}var P=["children"],C=["open"],k=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],z=["refKey","onChange","onClick"];function T(e){return function(e){if(Array.isArray(e))return L(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||I(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,i=[],a=!0,c=!1;try{for(t=t.call(e);!(a=(n=t.next()).done)&&(i.push(n.value),!r||i.length!==r);a=!0);}catch(u){c=!0,o=u}finally{try{a||null==t.return||t.return()}finally{if(c)throw o}}return i}(e,r)||I(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,r){if(e){if("string"==typeof e)return L(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?L(e,r):void 0}}function L(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function K(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function M(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?K(Object(t),!0).forEach((function(r){B(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):K(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function B(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var N=r.exports.forwardRef((function(e,n){var o=e.children,i=q(_(e,P)),a=i.open,c=_(i,C);return r.exports.useImperativeHandle(n,(function(){return{open:a}}),[a]),t.createElement(r.exports.Fragment,null,o(M(M({},c),{},{open:a})))}));N.displayName="Dropzone";var U={disabled:!1,getFilesFromEvent:o,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1};N.defaultProps=U,N.propTypes={children:n.func,accept:n.oneOfType([n.string,n.arrayOf(n.string)]),multiple:n.bool,preventDropOnDocument:n.bool,noClick:n.bool,noKeyboard:n.bool,noDrag:n.bool,noDragEventsBubbling:n.bool,minSize:n.number,maxSize:n.number,maxFiles:n.number,disabled:n.bool,getFilesFromEvent:n.func,onFileDialogCancel:n.func,onFileDialogOpen:n.func,useFsAccessApi:n.bool,onDragEnter:n.func,onDragLeave:n.func,onDragOver:n.func,onDrop:n.func,onDropAccepted:n.func,onDropRejected:n.func,validator:n.func};var $={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]};function q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=M(M({},U),e),n=t.accept,o=t.disabled,i=t.getFilesFromEvent,a=t.maxSize,c=t.minSize,u=t.multiple,l=t.maxFiles,s=t.onDragEnter,f=t.onDragLeave,p=t.onDragOver,g=t.onDrop,d=t.onDropAccepted,m=t.onDropRejected,j=t.onFileDialogCancel,x=t.onFileDialogOpen,P=t.useFsAccessApi,C=t.preventDropOnDocument,I=t.noClick,L=t.noKeyboard,K=t.noDrag,N=t.noDragEventsBubbling,q=t.validator,J=r.exports.useMemo((function(){return"function"==typeof x?x:G}),[x]),Q=r.exports.useMemo((function(){return"function"==typeof j?j:G}),[j]),V=r.exports.useRef(null),W=r.exports.useRef(null),X=r.exports.useReducer(H,$),Y=R(X,2),Z=Y[0],ee=Y[1],re=Z.isFocused,te=Z.isFileDialogActive,ne=Z.draggedFiles,oe=function(){te&&setTimeout((function(){W.current&&(W.current.files.length||(ee({type:"closeDialog"}),Q()))}),300)};r.exports.useEffect((function(){return P&&E()?function(){}:(window.addEventListener("focus",oe,!1),function(){window.removeEventListener("focus",oe,!1)})}),[W,te,Q,P]);var ie=r.exports.useRef([]),ae=function(e){V.current&&V.current.contains(e.target)||(e.preventDefault(),ie.current=[])};r.exports.useEffect((function(){return C&&(document.addEventListener("dragover",F,!1),document.addEventListener("drop",ae,!1)),function(){C&&(document.removeEventListener("dragover",F),document.removeEventListener("drop",ae))}}),[V,C]);var ce=r.exports.useCallback((function(e){e.preventDefault(),e.persist(),he(e),ie.current=[].concat(T(ie.current),[e.target]),O(e)&&Promise.resolve(i(e)).then((function(r){h(e)&&!N||(ee({draggedFiles:r,isDragActive:!0,type:"setDraggedFiles"}),s&&s(e))}))}),[i,s,N]),ue=r.exports.useCallback((function(e){e.preventDefault(),e.persist(),he(e);var r=O(e);if(r&&e.dataTransfer)try{e.dataTransfer.dropEffect="copy"}catch(t){}return r&&p&&p(e),!1}),[p,N]),le=r.exports.useCallback((function(e){e.preventDefault(),e.persist(),he(e);var r=ie.current.filter((function(e){return V.current&&V.current.contains(e)})),t=r.indexOf(e.target);-1!==t&&r.splice(t,1),ie.current=r,r.length>0||(ee({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),O(e)&&f&&f(e))}),[V,f,N]),se=r.exports.useCallback((function(e,r){var t=[],o=[];e.forEach((function(e){var r=R(v(e,n),2),i=r[0],u=r[1],l=R(b(e,c,a),2),s=l[0],f=l[1],p=q?q(e):null;if(i&&s&&!p)t.push(e);else{var g=[u,f];p&&(g=g.concat(p)),o.push({file:e,errors:g.filter((function(e){return e}))})}})),(!u&&t.length>1||u&&l>=1&&t.length>l)&&(t.forEach((function(e){o.push({file:e,errors:[y]})})),t.splice(0)),ee({acceptedFiles:t,fileRejections:o,type:"setFiles"}),g&&g(t,o,r),o.length>0&&m&&m(o,r),t.length>0&&d&&d(t,r)}),[ee,u,n,c,a,l,g,d,m,q]),fe=r.exports.useCallback((function(e){e.preventDefault(),e.persist(),he(e),ie.current=[],O(e)&&Promise.resolve(i(e)).then((function(r){h(e)&&!N||se(r,e)})),ee({type:"reset"})}),[i,se,N]),pe=r.exports.useCallback((function(){if(P&&E()){ee({type:"openDialog"}),J();var e={multiple:u,types:S(n)};window.showOpenFilePicker(e).then((function(e){return i(e)})).then((function(e){return se(e,null)})).catch((function(e){return Q(e)})).finally((function(){return ee({type:"closeDialog"})}))}else W.current&&(ee({type:"openDialog"}),J(),W.current.value=null,W.current.click())}),[ee,J,Q,P,se,n,u]),ge=r.exports.useCallback((function(e){V.current&&V.current.isEqualNode(e.target)&&(32!==e.keyCode&&13!==e.keyCode||(e.preventDefault(),pe()))}),[V,W,pe]),de=r.exports.useCallback((function(){ee({type:"focus"})}),[]),ye=r.exports.useCallback((function(){ee({type:"blur"})}),[]),ve=r.exports.useCallback((function(){I||(w()?setTimeout(pe,0):pe())}),[W,I,pe]),be=function(e){return o?null:e},me=function(e){return L?null:be(e)},De=function(e){return K?null:be(e)},he=function(e){N&&e.stopPropagation()},Oe=r.exports.useMemo((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.refKey,t=void 0===r?"ref":r,n=e.role,i=e.onKeyDown,a=e.onFocus,c=e.onBlur,u=e.onClick,l=e.onDragEnter,s=e.onDragOver,f=e.onDragLeave,p=e.onDrop,g=_(e,k);return M(M(B({onKeyDown:me(A(i,ge)),onFocus:me(A(a,de)),onBlur:me(A(c,ye)),onClick:be(A(u,ve)),onDragEnter:De(A(l,ce)),onDragOver:De(A(s,ue)),onDragLeave:De(A(f,le)),onDrop:De(A(p,fe)),role:"string"==typeof n&&""!==n?n:"button"},t,V),o||L?{}:{tabIndex:0}),g)}}),[V,ge,de,ye,ve,ce,ue,le,fe,L,K,o]),Fe=r.exports.useCallback((function(e){e.stopPropagation()}),[]),je=r.exports.useMemo((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.refKey,t=void 0===r?"ref":r,o=e.onChange,i=e.onClick,a=_(e,z),c=B({accept:n,multiple:u,type:"file",style:{display:"none"},onChange:be(A(o,fe)),onClick:be(A(i,Fe)),autoComplete:"off",tabIndex:-1},t,W);return M(M({},c),a)}}),[W,n,u,fe,o]),xe=ne.length,we=xe>0&&D({files:ne,accept:n,minSize:c,maxSize:a,multiple:u,maxFiles:l}),Ae=xe>0&&!we;return M(M({},Z),{},{isDragAccept:we,isDragReject:Ae,isFocused:re&&!o,getRootProps:Oe,getInputProps:je,rootRef:V,inputRef:W,open:be(pe)})}function H(e,r){switch(r.type){case"focus":return M(M({},e),{},{isFocused:!0});case"blur":return M(M({},e),{},{isFocused:!1});case"openDialog":return M(M({},$),{},{isFileDialogActive:!0});case"closeDialog":return M(M({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":var t=r.isDragActive,n=r.draggedFiles;return M(M({},e),{},{draggedFiles:n,isDragActive:t});case"setFiles":return M(M({},e),{},{acceptedFiles:r.acceptedFiles,fileRejections:r.fileRejections});case"reset":return M({},$);default:return e}}function G(){}var J=e(Object.freeze(Object.defineProperty({__proto__:null,default:N,useDropzone:q,ErrorCode:f},Symbol.toStringTag,{value:"Module"})));export{J as r};
